function getRandomInt(n,t){return Math.floor(Math.random()*(t-n+1))+n}var speciesSet=[{name:"Sycek",sets:[{name:"Jiřička Hrůzostrašná",subSets:[["sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_10.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_11.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_12.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_14.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_15.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_16.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_20.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_22.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_25.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_27.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_31.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_33.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_38.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_40.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_42.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_44.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_47.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_49.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_51.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_52.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_53.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_54.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_58.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_6.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_64.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_66.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_68.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_69.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_70.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_72.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_73.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_74.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_8.wav","sounds/sycek/001/108_ci_109_2013/108_ci_109_2013_9.wav"],["sounds/sycek/001/108-109b_2014/108-109b_2014_10.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_11.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_12.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_13.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_14.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_15.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_16.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_17.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_18.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_19.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_2.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_20.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_21.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_3.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_4.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_5.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_6.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_7.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_8.wav","sounds/sycek/001/108-109b_2014/108-109b_2014_9.wav",]]},{name:"Satan Klausův",subSets:[["sounds/sycek/002/193_2013/193_2013_10.wav","sounds/sycek/002/193_2013/193_2013_11.wav","sounds/sycek/002/193_2013/193_2013_12.wav","sounds/sycek/002/193_2013/193_2013_13.wav","sounds/sycek/002/193_2013/193_2013_14.wav","sounds/sycek/002/193_2013/193_2013_15.wav","sounds/sycek/002/193_2013/193_2013_16.wav","sounds/sycek/002/193_2013/193_2013_17.wav","sounds/sycek/002/193_2013/193_2013_18.wav","sounds/sycek/002/193_2013/193_2013_19.wav","sounds/sycek/002/193_2013/193_2013_2.wav","sounds/sycek/002/193_2013/193_2013_20.wav","sounds/sycek/002/193_2013/193_2013_21.wav","sounds/sycek/002/193_2013/193_2013_22.wav","sounds/sycek/002/193_2013/193_2013_23.wav","sounds/sycek/002/193_2013/193_2013_24.wav","sounds/sycek/002/193_2013/193_2013_25.wav","sounds/sycek/002/193_2013/193_2013_3.wav","sounds/sycek/002/193_2013/193_2013_5.wav","sounds/sycek/002/193_2013/193_2013_6.wav","sounds/sycek/002/193_2013/193_2013_7.wav","sounds/sycek/002/193_2013/193_2013_8.wav","sounds/sycek/002/193_2013/193_2013_9.wav",],["sounds/sycek/002/193b_2014/193b_2014_1.wav","sounds/sycek/002/193b_2014/193b_2014_10.wav","sounds/sycek/002/193b_2014/193b_2014_11.wav","sounds/sycek/002/193b_2014/193b_2014_12.wav","sounds/sycek/002/193b_2014/193b_2014_13.wav","sounds/sycek/002/193b_2014/193b_2014_14.wav","sounds/sycek/002/193b_2014/193b_2014_15.wav","sounds/sycek/002/193b_2014/193b_2014_16.wav","sounds/sycek/002/193b_2014/193b_2014_17.wav","sounds/sycek/002/193b_2014/193b_2014_18.wav","sounds/sycek/002/193b_2014/193b_2014_19.wav","sounds/sycek/002/193b_2014/193b_2014_2.wav","sounds/sycek/002/193b_2014/193b_2014_20.wav","sounds/sycek/002/193b_2014/193b_2014_21.wav","sounds/sycek/002/193b_2014/193b_2014_22.wav","sounds/sycek/002/193b_2014/193b_2014_23.wav","sounds/sycek/002/193b_2014/193b_2014_24.wav","sounds/sycek/002/193b_2014/193b_2014_25.wav","sounds/sycek/002/193b_2014/193b_2014_26.wav","sounds/sycek/002/193b_2014/193b_2014_27.wav","sounds/sycek/002/193b_2014/193b_2014_3.wav","sounds/sycek/002/193b_2014/193b_2014_4.wav","sounds/sycek/002/193b_2014/193b_2014_5.wav","sounds/sycek/002/193b_2014/193b_2014_6.wav","sounds/sycek/002/193b_2014/193b_2014_7.wav","sounds/sycek/002/193b_2014/193b_2014_8.wav","sounds/sycek/002/193b_2014/193b_2014_9.wav",]]},{name:"Krůta Ukrutná",subSets:[["sounds/sycek/003/229_spont_2013/229_spont_2013_10.wav","sounds/sycek/003/229_spont_2013/229_spont_2013_11.wav","sounds/sycek/003/229_spont_2013/229_spont_2013_12.wav","sounds/sycek/003/229_spont_2013/229_spont_2013_13.wav","sounds/sycek/003/229_spont_2013/229_spont_2013_14.wav","sounds/003/229_spont_2013/229_spont_2013_15.wav","sounds/003/229_spont_2013/229_spont_2013_16.wav","sounds/003/229_spont_2013/229_spont_2013_17.wav","sounds/003/229_spont_2013/229_spont_2013_18.wav","sounds/003/229_spont_2013/229_spont_2013_19.wav","sounds/003/229_spont_2013/229_spont_2013_2.wav","sounds/003/229_spont_2013/229_spont_2013_3.wav","sounds/003/229_spont_2013/229_spont_2013_4.wav","sounds/003/229_spont_2013/229_spont_2013_5.wav","sounds/003/229_spont_2013/229_spont_2013_6.wav","sounds/003/229_spont_2013/229_spont_2013_7.wav","sounds/003/229_spont_2013/229_spont_2013_8.wav","sounds/003/229_spont_2013/229_spont_2013_9.wav"],["sounds/003/229b_2014/229b_2014_10.wav","sounds/003/229b_2014/229b_2014_11.wav","sounds/003/229b_2014/229b_2014_12.wav","sounds/003/229b_2014/229b_2014_13.wav","sounds/003/229b_2014/229b_2014_14.wav","sounds/003/229b_2014/229b_2014_15.wav","sounds/003/229b_2014/229b_2014_16.wav","sounds/003/229b_2014/229b_2014_17.wav","sounds/003/229b_2014/229b_2014_18.wav","sounds/003/229b_2014/229b_2014_19.wav","sounds/003/229b_2014/229b_2014_2.wav","sounds/003/229b_2014/229b_2014_20.wav","sounds/003/229b_2014/229b_2014_21.wav","sounds/003/229b_2014/229b_2014_22.wav","sounds/003/229b_2014/229b_2014_23.wav","sounds/003/229b_2014/229b_2014_24.wav","sounds/003/229b_2014/229b_2014_25.wav","sounds/003/229b_2014/229b_2014_3.wav","sounds/003/229b_2014/229b_2014_4.wav","sounds/003/229b_2014/229b_2014_5.wav","sounds/003/229b_2014/229b_2014_6.wav","sounds/003/229b_2014/229b_2014_7.wav","sounds/003/229b_2014/229b_2014_8.wav","sounds/003/229b_2014/229b_2014_9.wav",]]},{name:"Pěnkava Umrlá",subSets:[["sounds/004/7_2013/7_2013_1.wav","sounds/004/7_2013/7_2013_12.wav","sounds/004/7_2013/7_2013_13.wav","sounds/004/7_2013/7_2013_14.wav","sounds/004/7_2013/7_2013_15.wav","sounds/004/7_2013/7_2013_16.wav","sounds/004/7_2013/7_2013_17.wav","sounds/004/7_2013/7_2013_2.wav","sounds/004/7_2013/7_2013_4.wav","sounds/004/7_2013/7_2013_8.wav",],["sounds/004/7_2014/7_2014_10.wav","sounds/004/7_2014/7_2014_11.wav","sounds/004/7_2014/7_2014_12.wav","sounds/004/7_2014/7_2014_13.wav","sounds/004/7_2014/7_2014_14.wav","sounds/004/7_2014/7_2014_15.wav","sounds/004/7_2014/7_2014_16.wav","sounds/004/7_2014/7_2014_17.wav","sounds/004/7_2014/7_2014_2.wav","sounds/004/7_2014/7_2014_3.wav","sounds/004/7_2014/7_2014_4.wav","sounds/004/7_2014/7_2014_5.wav","sounds/004/7_2014/7_2014_6.wav","sounds/004/7_2014/7_2014_7.wav","sounds/004/7_2014/7_2014_8.wav","sounds/004/7_2014/7_2014_9.wav"]]},{name:"Ostuda Obecná",subSets:[["sounds/005/94_2013/94_2013_10.wav","sounds/005/94_2013/94_2013_2.wav","sounds/005/94_2013/94_2013_3.wav","sounds/005/94_2013/94_2013_4.wav","sounds/005/94_2013/94_2013_5.wav",],["sounds/005/94_2014/94_2014_10.wav","sounds/005/94_2014/94_2014_11.wav","sounds/005/94_2014/94_2014_12.wav","sounds/005/94_2014/94_2014_13.wav","sounds/005/94_2014/94_2014_14.wav","sounds/005/94_2014/94_2014_15.wav","sounds/005/94_2014/94_2014_16.wav","sounds/005/94_2014/94_2014_17.wav","sounds/005/94_2014/94_2014_2.wav","sounds/005/94_2014/94_2014_3.wav","sounds/005/94_2014/94_2014_4.wav","sounds/005/94_2014/94_2014_5.wav","sounds/005/94_2014/94_2014_6.wav","sounds/005/94_2014/94_2014_7.wav","sounds/005/94_2014/94_2014_8.wav","sounds/005/94_2014/94_2014_9.wav"]]}]}],currentSpeciesIndex=0;(function(){function n(n){function g(){var n=new Date,t=n-b,i=JSON.stringify({id:v,duration:t,finishedTime:n,movesCount:k});$.ajax({url:"/api/games/",type:"post",data:i,dataType:"json",accept:"application/json",contentType:"application/json"})}function o(n,t){var i=new Date,r,u;r=a!=null?i-a:null;u=JSON.stringify({label:n,card:t,time:i,millisecondsSinceLastEvent:r,gameId:v});a=i;$.ajax({url:"/api/events/",type:"post",data:u,dataType:"json",accept:"application/json",contentType:"application/json",success:function(n){v=n},error:function(n){alert(n)}})}var p=n.sets,l=!1,f=n.cardCount,w=p.length,i=null,s=0,a=null,b=null,v=null,k=0,r,u,h,y,c,d,t,e;for(f>w*2&&alert("More cards than sets."),r=[],u=[],t=0;t<w;t++)u.push({index:t,weight:getRandomInt(0,1e3),species:p[t]});for(u.sort(function(n,t){return n.weight-t.weight}),speciesIndex=0,t=0;t<f;t+=2,speciesIndex++){for(h=[],y=u[speciesIndex].species.subSets,c=0;c<y.length;c++)d=getRandomInt(0,y[c].length-1),h.push({weight:getRandomInt(0,1e3),url:u[speciesIndex].species.subSets[c][d]});h.sort(function(n,t){return n.weight-t.weight});r.push({setIndex:u[speciesIndex].index,weight:getRandomInt(0,1e3),url:h[0].url,name:u[speciesIndex].species.name});r.push({setIndex:u[speciesIndex].index,weight:getRandomInt(0,1e3),url:h[1].url,name:u[speciesIndex].species.name})}for(r.sort(function(n,t){return n.weight-t.weight}),b=new Date,o("started",null),t=0;t<f;t++){r[t].cardId="#card"+t;e=r[t];$(e.cardId).addClass("cardCovered");$(e.cardId).empty();console.log(e);$(document).on("click",e.cardId,e,function(n){var e;if(!l){l=!0;var u=n.data.cardId,h=n.data.url,t=n.data;$(u).addClass("cardPlaying");$(u).removeClass("cardCovered");$(u).addClass("cardUncovered");e=new Audio(h);e.onended=function(){if($(t.cardId).removeClass("cardPlaying"),l=!1,console.log("Sound finished for card: "),console.log(t),console.log("First selected card: "+i),console.log(i),s<f)if(k++,console.log("matchCount "+s+"; cardCount "+f),i!=null&&i.cardId!=t.cardId){if(i.setIndex!=t.setIndex)$(t.cardId).removeClass("cardUncovered"),$(t.cardId).addClass("cardCovered"),$(i.cardId).removeClass("cardUncovered"),$(i.cardId).addClass("cardCovered"),o("mismatch",t.url);else{if(s+=2,console.log(s+", "+f),s>=f){for(var n=0;n<f;n++)console.log(r[n]),$(r[n].cardId).text(r[n].name);won=!0}o("match",t.url);g()}i=null}else o("first",t.url),i=t;else o("after the win",t.url)};e.play();console.log("Card selected: ");console.log(t)}})}}$.getJSON("/api/species/"+speciesName,function(t){n(t)})})();